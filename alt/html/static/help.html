<!DOCTYPE html>
<html>
  <head>
    <title>CTBRec Help (Server)</title>
    <style>
      html * {
        font-size: 12px;
        line-height: 1.625;
        color: #2020131;
        font-family: Nunito, sans-serif;
      }
    </style>
  </head>
  <body style="color: black; background-color: white;" alink="#3333ff" link="#3366ff" vlink="#990099">
    <a href="#configuration-file" name="Configuration_File">Configuration File</a>&nbsp;&nbsp;&nbsp; <a href="#post-processing" name="Post-Processing">Post-Processing</a>&nbsp;&nbsp;&nbsp; <a href="#how-to-run-the-server" name="How_To_Run_The_Server">How To Run The Server</a>
    <br>
    <br>
    <h2 style="color: rgb(51, 51, 255); font-size: 16px;" id="configuration-file">Configuration File</h2>
    <p>The configuration file stores all your settings and recorded models.</p>
    <h3 style="color: rgb(255, 153, 0); font-size: 14px;" id="location">Location</h3>
    <p>ctbrec application:</p>
    <ul>
      <li>Windows: <code>C:\Users\&lt;user&gt;\AppData\Roaming\ctbrec\&lt;version&gt;\settings.json</code>
      </li>
      <li>Linux: <code>~/.config/ctbrec/&lt;version&gt;/settings.json</code>
      </li>
      <li>MacOS: <code>/Users/&lt;user&gt;/Library/Preferences/ctbrec/&lt;version&gt;/settings.json</code>
      </li>
    </ul>
    <p>server:</p>
    <ul>
      <li>Windows: <code>C:\Users\&lt;user&gt;\AppData\Roaming\ctbrec\&lt;version&gt;\server.json</code>
      </li>
      <li>Linux: <code>~/.config/ctbrec/&lt;version&gt;/server.json</code>
      </li>
      <li>MacOS: <code>/Users/&lt;user&gt;/Library/Preferences/ctbrec/&lt;version&gt;/server.json</code>
      </li>
    </ul>
    <h3 style="color: rgb(255, 153, 0); font-size: 14px;" id="values">Values</h3>
    <p>The application and the server share the same configuration file structure, that's why there are values which don't make sense in the server configuration and vice versa. These values are simply ignored.</p>
    <p>This is a collection of the most interesting values:</p>
    <table style="text-align: left; width: 80%; background-color: silver;" border="1" cellpadding="1" cellspacing="1">
      <tbody>
        <tr>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Name</span>
          </th>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Scope</span>
          </th>
          <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Type</th>
          <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Description</th>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>chooseStreamQuality</strong></td>
          <td style="vertical-align: top;">Application </td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">Opens the stream resolution selection dialog, when you start recording a model.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>concurrentRecordings</strong></td>
          <td style="vertical-align: top;">Application/Server </td>
          <td style="vertical-align: top;">Integer [0 - 2147483647]</td>
          <td style="vertical-align: top;">Limits the number of concurrently running recordings. Once this number is reached, now more recordings are started until a recording is finished. 0 means unlimited.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>determineResolution</strong></td>
          <td style="vertical-align: top;">Application</td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">Display the stream resolution on the thumbnails.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>hlsdlExecutable</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [filesystem path] </td>
          <td style="vertical-align: top;">Path to the hlsdl executable, which is used, if <code>useHlsdl</code> is set to true </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>httpPort</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Integer [1 - 65536]</td>
          <td style="vertical-align: top;">The TCP port, the server listens on. In the server config, this will tell the server, which port to use. In the application this will set the port ctbrec tries to connect to, if it is run in remote mode.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>httpServer</strong></td>
          <td style="vertical-align: top;">Application</td>
          <td style="vertical-align: top;">IP/FQDN </td>
          <td style="vertical-align: top;">The TCP host where the server is running. Has no effect, if ctbrec is run in local recording mode.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>httpTimeout</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Milliseconds [1 - 2147483647]</td>
          <td style="vertical-align: top;">In the server configuration this sets the idle timeout for connections to the server. In the app this sets the connect and read timeout for any HTTP connection.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>httpUserAgent</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [UserAgent] </td>
          <td style="vertical-align: top;">The user agent, which is used in the HTTP header, when ctbrec connects to a camsite. This is used to disguise that it actually is a recording software :)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>httpUserAgentMobile</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [UserAgent]</td>
          <td style="vertical-align: top;">Same as <em>httpUserAgent</em>, but in same cases we have to pretend to be a mobile phone :) </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>key</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">
            <br>
          </td>
          <td style="vertical-align: top;">Key for the HMAC based authentication. If this is set in server config and contains values the HMAC authentication is automatically active.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>livePreviews</strong></td>
          <td style="vertical-align: top;">Application</td>
          <td style="vertical-align: top;">
            <br>
          </td>
          <td style="vertical-align: top;">Enables the live preview feature in the app.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>logFFmpegOutput</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">The output from FFmpeg (from recordings or post-processing steps) will be logged in temporary files.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>loghlsdlOutput</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">The output from hlsdl will be logged in temporary files. Only in effect, if <code>useHlsdl</code> is set to true </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>minimumResolution</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Integer [1 - 2147483647]</td>
          <td style="vertical-align: top;">Sets the minimum video height for a recording. ctbrec tries to find a stream quality, which is higher than or equal to this value. If the only provided stream quality is below this threshold, ctbrec won't record the stream.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>maximumResolution</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Integer [1 - 2147483647]</td>
          <td style="vertical-align: top;">Sets the maximum video height for a recording. ctbrec tries to find a stream quality, which is lower than or equal to this value. If the only provided stream quality is above this threshold, ctbrec won't record the stream.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>minimumLengthInSeconds</strong></td>
          <td style="vertical-align: top;">
            <span style="font-weight: bold; color: rgb(255, 0, 0);">Deprecated</span>
            <br> See <a href="help.html#post-processing">Post-Processing</a>
          </td>
          <td style="vertical-align: top;">Integer [1 - 2147483647]</td>
          <td style="vertical-align: top;">Automatically delete recordings, which are shorter than this amount of seconds. 0 disables this feature.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>minimumSpaceLeftInBytes</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Integer [0 - 9223372036854775807]</td>
          <td style="vertical-align: top;">The space in bytes ctbrec should conserve on the hard drive. 1 GiB = 1024 MiB = 1048576 KiB = 1073741824 bytes</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>onlineCheckIntervalInSecs</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Integer [1 - 2147483647]</td>
          <td style="vertical-align: top;">How often ctbrec checks, if a model is online. This is not a guaranteed interval: If you record many models, the online check for all models can take longer than this interval. A minute is a reasonable value, but you can go lower, if you don't want to miss a anything. But don't go too low, or you risk to do too many requests in a short amount of time and get banned by some sites.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>onlineCheckSkipsPausedModels</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">Skip the online check for paused models. If you have many models in the recording list, this can reduce the delay when a recording starts after a model came online.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>postProcessing</strong></td>
          <td style="vertical-align: top;">
            <span style="font-weight: bold; color: rgb(255, 0, 0);">Deprecated</span>
            <br> See <a href="help.html#post-processing">Post-Processing</a>
          </td>
          <td style="vertical-align: top;">String [filesystem path]</td>
          <td style="vertical-align: top;">Absolute path to a script, which is executed once a recording is finished.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>recordingsDir</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [filesystem path]</td>
          <td style="vertical-align: top;">Where ctbrec saves the recordings.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>recordingsDirStructure</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [ <code>FLAT</code>, <code>ONE_PER_MODEL</code>, <code>ONE_PER_RECORDING</code>] </td>
          <td style="vertical-align: top;">How recordings are stored in the file system. <code>FLAT</code> - all recordings in one directory; <code>ONE_PER_MODEL</code> - one directory per model; <code>ONE_PER_RECORDING</code> - each recordings ends up in its own directory. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>recordSingleFile</strong></td>
          <td style="vertical-align: top;">Server </td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">How recordings are stored in the file system. <code>true</code> means, each recording is saved in one large file. <code>false</code> means, ctbrec just downloads the stream segments. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>splitStrategy</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">String [ <code>DONT</code>, <code>TIME</code>, <code>SIZE</code>, <code>TIME_OR_SIZE</code>] </td>
          <td style="vertical-align: top;">Defines if and how to split recordings. Also see <code>splitRecordingsAfterSecs</code> and <code>splitRecordingsBiggerThanBytes</code>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>splitRecordingsAfterSecs</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Seconds [0 - 2147483647]</td>
          <td style="vertical-align: top;">Split recordings after this amount of seconds. The recordings are split up into several individual recordings, which have the defined length (roughly). Has to be activated with <code>splitStrategy</code>. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>splitRecordingsBiggerThanBytes</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Bytes [0 - 9223372036854775807]</td>
          <td style="vertical-align: top;">Split recordings, if the size on disk exceeds this value. The recordings are split up into several individual recordings, which have the defined size (roughly). Has to be activated with <code>splitStrategy</code>. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>timeoutRecordingStartingAt</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">24 hour time HH:MM [00:00 - 23:59]</td>
          <td style="vertical-align: top;">Start of the recording timeout timeframe - No new recordings will be started in this period</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>timeoutRecordingEndingAt</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">24 hour time HH:MM [00:00 - 23:59]</td>
          <td style="vertical-align: top;">End of the recording timeout timeframe - No new recordings will be started in this period</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>useHlsdl</strong></td>
          <td style="vertical-align: top;">Application/Server</td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">Use hlsdl to record the live streams. You also have to set <code>hlsdlExecutable</code>, if hlsdl is not globally available on your system. hlsdl won't be used for MV Live, LiveJasmin and Showup. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>webinterface</strong></td>
          <td style="vertical-align: top;">Server </td>
          <td style="vertical-align: top;">Boolean [ <code>true</code>, <code>false</code>] </td>
          <td style="vertical-align: top;">Enables the webinterface for the server. You can access it with <a href="http://host/static/index.html">http://host:port/static/index.html</a> Don't activate this on a machine which can be accessed from the internet because this is totally unprotected at the moment. </td>
        </tr>
      </tbody>
    </table>
    <hr style="width: 100%; height: 1px;">
    <h2 style="color: rgb(51, 51, 255); font-size: 16px;" id="post-processing">Post-Processing</h2>
    <p>The post-processing gives you the possibility to execute different actions after a recording has finished. You can use that to convert the files to another format, create preview images, rename / move the file etc.</p>
    <h3 style="color: rgb(255, 153, 0); font-size: 14px;" id="available-steps">Available Steps</h3>
    <table style="text-align: left; width: 80%; background-color: silver;" border="1" cellpadding="1" cellspacing="1">
      <tbody>
        <tr>
          <th style="vertical-align: top; font-weight: bold; font-size: 14px;">
            <b>Step</b>
          </th>
          <th style="vertical-align: top; font-weight: bold; font-size: 14px;">
            <b>Description</b>
          </th>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>create a copy</strong></td>
          <td style="vertical-align: top;">Creates a copy of the original recording. All following post-processing steps are executed on the copy, not on the original recording. This means, that the post-processing can be rerun in case a step failed, because the original recording is still available.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>rename</strong></td>
          <td style="vertical-align: top;">Renames the recording with the help of variables. See <a href="help.html#variables">Variables</a>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>move</strong></td>
          <td style="vertical-align: top;">Moves the recording with the help of variables. See <a href="help.html#variables">Variables</a>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>remux / transcode</strong></td>
          <td style="vertical-align: top;">Executes FFmpeg with the given arguments on the recording. This step can be used to convert a recording to MP4 or re-encode it to a different format / resolution. The input and output file don't have to be defined. If the step was successful the input file gets deleted.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>execute script</strong></td>
          <td style="vertical-align: top;">Executes a script or program with the given arguments. You can use the <a href="help.html#variables">variables</a> to define what to pass over to the script. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>delete too short</strong></td>
          <td style="vertical-align: top;">Delete a recording, if it is shorter than the given duration. This post-processing step has replaced the setting, which was available in the post-processing category before.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>delete original</strong></td>
          <td style="vertical-align: top;">This is a companion step for "create a copy". If you use the copy step and all other steps are successful, you probably want to get rid of the original file and just keep the result of the post-processing. That's what this step does.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>remove recording, but keep the files</strong></td>
          <td style="vertical-align: top;">Removes the recording from the recordings list, but keeps the files untouched.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><strong>create contactsheet</strong></td>
          <td style="vertical-align: top;">Create a contact sheet with preview images of the recording.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4 id="planned-for-future-releases">Planned for future releases</h4>
    <ul>
      <li>
        <strong>call a webhook</strong> - call a URL once a recording is finished
      </li>
      <li>
        <strong>create timeline thumbnails</strong> - create a small thumbnail for every second or every few seconds, which can be used to very fast scan through a recording
      </li>
    </ul>
    <h4 style="text-decoration: underline;" id="how-to-configure-the-server-to-do-post-processing">How to configure the server to do post-processing</h4>
    <p>There is currently no user interface to configure the post-processing for the server, it has to be added manually to the server config.</p>
    <p>I suggest to start the app and configure the post-processing steps in the settings, afterwards you close the app and copy the post-processing section from the settings.json to your server.json file.</p>
    <p>To find out, where these files are on your system, read <a href="#configuration-file">Configuration File</a>. </p>
    <p>The part you have to copy is</p>
		<code>postProcessors: [<br>
          &nbsp;&nbsp;...<br>
					],
		</code>
    <h3 style="color: rgb(255, 153, 0); font-size: 14px;" id="variables">Variables</h3>
    <table style="text-align: left; width: 80%; background-color: silver;" border="1" cellpadding="1" cellspacing="1">
      <tbody>
        <tr>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Variable name</span>
            <br>
          </th>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Description</span>
            <br>
          </th>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>${modelName}</strong>
          </td>
          <td style="vertical-align: top;">the name of the recorded model</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>${modelDisplayName}</strong>
          </td>
          <td style="vertical-align: top;">the name of the recorded model, which is shown on the webpage. Might be the same as ${modelName}</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${modelGroupName}</strong>
          </td>
          <td style="vertical-align: top;">name of the model group, if the model is part of a group</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${modelGroupId}</strong>
          </td>
          <td style="vertical-align: top;">the unique ID of the model group, if the model is part of a group</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${siteName}</strong>
          </td>
          <td style="vertical-align: top;">the name of the cam site, the model streams on</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>${fileSuffix}</strong>
          </td>
          <td style="vertical-align: top;">the file extension of the recording, e.g. ts or mp4. In case of a standard server recording, this will be empty</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>${epochSecond}</strong>
          </td>
          <td style="vertical-align: top;">timestamp of the recording in seconds since 1970-01-01 (unixtime)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${modelNotes}</strong>
          </td>
          <td style="vertical-align: top;">sanitized model notes. The following characters are replaced by an underscore: \, /, ', " and space</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${recordingNotes}</strong>
          </td>
          <td style="vertical-align: top;">sanitized recording notes. The following characters are replaced by an underscore: \, /, ', " and space. Useful for the download of recordings from the server.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${recordingsDir}</strong>
          </td>
          <td style="vertical-align: top;">the base directory of all recordings. Same as Recordings Directory in the Recorder settings section.</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${absolutePath}</strong>
          </td>
          <td style="vertical-align: top;">the absolute path in the filesystem to the recording file (or the recording directory in case of a server recording)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
              <strong>${absoluteParentPath}</strong>
          </td>
          <td style="vertical-align: top;">the absolute path to the parent directory of the recording in the filesystem (or the recording dir in case of a server recording)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>${utcDateTime}</strong> and <strong>${localDateTime}</strong>
          </td>
          <td style="vertical-align: top;">the timestamp of the recording in the UTC or your local timezone</td>
        </tr>
      </tbody>
    </table>
    <br>
    <h3 style="color: rgb(255, 153, 0); font-size: 14px;" id="functions">Functions</h3>
    <table style="text-align: left; width: 80%; background-color: silver;" border="1" cellpadding="1" cellspacing="1">
      <tbody>
        <tr>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Function&nbsp;name&nbsp;&nbsp;&nbsp;</span>
            <br>
          </th>
          <th style="vertical-align: top;">
            <span style="font-weight: bold; font-size: 14px;">Description</span>
            <br>
          </th>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$trim</strong>
          </td>
          <td style="vertical-align: top;">Removes all leading and trailing space - <code>$trim(' hello world ')</code> becomes: <code>'hello world'</code>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$upper</strong>
          </td>
          <td style="vertical-align: top;">Converts all of the characters to upper case - <code>$upper(hello world)</code> becomes: <code>HELLO WORLD</code>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$lower</strong>
          </td>
          <td style="vertical-align: top;">Converts all of the characters to lower case - <code>$lower(hElLo WORLD)</code> becomes: <code>hello world</code>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$capitalize</strong>
          </td>
          <td style="vertical-align: top;">Capitalizes words changing the first character to upper case - <code>$capitalize(hElLo WorLD)</code> becomes: <code>Hello World</code>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$sanitize</strong>
          </td>
          <td style="vertical-align: top;">Removes problematic characters - <code>$sanitize(hEl'Lo / WO"RLD)</code> becomes <code>hEl_Lo___WO_RLD</code>. The following characters are replaced by an underscore: \, /, ', " and space. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$orElse</strong>
          </td>
          <td style="vertical-align: top;">Provide an alternative in case a variable is not set - <code>$orElse(${variable},someValue)</code> - becomes <code>${variable}</code>, if it is set or <code>someValue</code>, if <code>${variable}</code> is not set. </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
            <strong>$format</strong>
          </td>
          <td style="vertical-align: top;">Formats a date, can be used with a pattern or without. Examples: <br>
            <ul>
              <li>
                <code>$format(${localDateTime})</code> - becomes something like <code>2023-02-26_12-23-15</code>
              </li>
              <li>
                <code>$format(${localDateTime},yyyyMMdd-HHmmss)</code> would lead to <code>20200928-173605</code>
              </li>
            </ul>
            <table style="text-align: left; background-color: silver;" border="0" cellpadding="1" cellspacing="1">
              <tbody>
                <tr>
                  <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Symbol</th>
                  <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Meaning</th>
                  <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Presentation</th>
                  <th style="vertical-align: top; font-weight: bold; font-size: 14px;">Examples</th>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;G</td>
                  <td style="vertical-align: top;">era</td>
                  <td style="vertical-align: top;">text</td>
                  <td style="vertical-align: top;">AD; Anno Domini; A</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;u</td>
                  <td style="vertical-align: top;">year</td>
                  <td style="vertical-align: top; text-align: left;">year</td>
                  <td style="vertical-align: top;">2004; 04</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;y</td>
                  <td style="vertical-align: top;">year-of-era</td>
                  <td style="vertical-align: top;">year</td>
                  <td style="vertical-align: top;">2004; 04</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;D</td>
                  <td style="vertical-align: top;">day-of-year</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">189</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;M/L</td>
                  <td style="vertical-align: top;">month-of-year</td>
                  <td style="vertical-align: top;">number/text</td>
                  <td style="vertical-align: top;">7; 07; Jul; July; J</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;d</td>
                  <td style="vertical-align: top;">day-of-month</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">10</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;g</td>
                  <td style="vertical-align: top;">modified-julian-day</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">2451334</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;Q/q</td>
                  <td style="vertical-align: top;">quarter-of-year</td>
                  <td style="vertical-align: top;">number/text</td>
                  <td style="vertical-align: top;">3; 03; Q3; 3rd quarter</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;Y</td>
                  <td style="vertical-align: top;">week-based-year</td>
                  <td style="vertical-align: top;">year</td>
                  <td style="vertical-align: top;">1996; 96</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;w</td>
                  <td style="vertical-align: top;">week-of-week-based-year</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">27</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;W</td>
                  <td style="vertical-align: top;">week-of-month</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">4</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;E</td>
                  <td style="vertical-align: top;">day-of-week</td>
                  <td style="vertical-align: top;">text</td>
                  <td style="vertical-align: top;">Tue; Tuesday; T</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;e/c</td>
                  <td style="vertical-align: top;">localized day-of-week</td>
                  <td style="vertical-align: top;">number/text</td>
                  <td style="vertical-align: top;">2; 02; Tue; Tuesday; T</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;F</td>
                  <td style="vertical-align: top;">day-of-week-in-month</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">3</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;a</td>
                  <td style="vertical-align: top;">am-pm-of-day</td>
                  <td style="vertical-align: top;">text</td>
                  <td style="vertical-align: top;">PM</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;h</td>
                  <td style="vertical-align: top;">clock-hour-of-am-pm (1-12)</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">12</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;K</td>
                  <td style="vertical-align: top;">hour-of-am-pm (0-11)</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">0</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;k</td>
                  <td style="vertical-align: top;">clock-hour-of-day (1-24)</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">24</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;H</td>
                  <td style="vertical-align: top;">hour-of-day (0-23)</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">0</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;m</td>
                  <td style="vertical-align: top;">minute-of-hour</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">30</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;s</td>
                  <td style="vertical-align: top;">second-of-minute</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">55</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;S</td>
                  <td style="vertical-align: top;">fraction-of-second</td>
                  <td style="vertical-align: top;">fraction</td>
                  <td style="vertical-align: top;">978</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;A</td>
                  <td style="vertical-align: top;">milli-of-day</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">1234</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;n</td>
                  <td style="vertical-align: top;">nano-of-second</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">987654321</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;N</td>
                  <td style="vertical-align: top;">nano-of-day</td>
                  <td style="vertical-align: top;">number</td>
                  <td style="vertical-align: top;">1234000000</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;V</td>
                  <td style="vertical-align: top;">time-zone ID</td>
                  <td style="vertical-align: top;">zone-id</td>
                  <td style="vertical-align: top;">America/Los_Angeles; Z; -08:30</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;v</td>
                  <td style="vertical-align: top;">generic time-zone name</td>
                  <td style="vertical-align: top;">zone-name</td>
                  <td style="vertical-align: top;">Pacific Time; PT</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;z</td>
                  <td style="vertical-align: top;">time-zone name</td>
                  <td style="vertical-align: top;">zone-name</td>
                  <td style="vertical-align: top;">Pacific Standard Time; PST</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;O</td>
                  <td style="vertical-align: top;">localized zone-offset</td>
                  <td style="vertical-align: top;">offset-O</td>
                  <td style="vertical-align: top;">GMT+8; GMT+08:00; UTC-08:00</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;X</td>
                  <td style="vertical-align: top;">zone-offset 'Z' for zero</td>
                  <td style="vertical-align: top;">offset-X</td>
                  <td style="vertical-align: top;">Z; -08; -0830; -08:30; -083015; -08:30:15</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;x</td>
                  <td style="vertical-align: top;">zone-offset</td>
                  <td style="vertical-align: top;">offset-x</td>
                  <td style="vertical-align: top;">+0000; -08; -0830; -08:30; -083015; -08:30:15</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;Z</td>
                  <td style="vertical-align: top;">zone-offset</td>
                  <td style="vertical-align: top;">offset-Z</td>
                  <td style="vertical-align: top;">+0000; -0800; -08:00</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;p</td>
                  <td style="vertical-align: top;">pad next</td>
                  <td style="vertical-align: top;">pad modifier</td>
                  <td style="vertical-align: top;">1</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">&nbsp;'</td>
                  <td style="vertical-align: top;">escape for text delimiter ''</td>
                  <td style="vertical-align: top;">single quote literal</td>
                  <td style="vertical-align: top;">'</td>
                </tr>
              </tbody>
            </table>
            <br> For more information see: <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/format/DateTimeFormatter.html">DateTimeFormatter</a>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4 style="color: rgb(255, 153, 0); font-size: 14px;" id="full-example">Full Example</h4>
      <code>$orElse(${modelGroupName},$sanitize(${modelName}))_$format(${localDateTime})_${recordingNotes}</code>
      <br>
    <hr style="width: 100%; height: 1px;">
    <h2 style="color: rgb(51, 51, 255); font-size: 16px;" id="how-to-run-the-server">How To Run The Server</h2>
    <iframe src="https://www.youtube.com/embed/vBP4aawOB4E" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0" height="315" width="560"></iframe>
    <hr style="width: 100%; height: 1px;">
    <p></p>
    <h3 style="color: rgb(0, 0, 0); font-size: 14px;">!!! First things first !!!</h3>
    <u>If you expose the server to the internet, I highly recommend enabling authentication and secure communication via TLS. Otherwise the whole world has access to your CTB Recorder server.</u>
    <hr style="width: 100%; height: 1px;">
    <br>
    <p>The archive you downloaded contains a <code>server.bat</code> or <code>server.sh</code>, which can be used to start the server. On the first start, the server uses a default configuration. Once you terminate the server by pressing <kbd>ctrl</kbd> + <kbd>c</kbd>, the config is stored in your user home. </p>
    <p>Windows: <code>C:\Users\&lt;user&gt;\AppData\Roaming\ctbrec\&lt;version&gt;\server.json</code>
    </p>
    <p>Linux: <code>~/.config/ctbrec/server.json</code>
    </p>
    <p>MacOS: <code>/Users/&lt;user&gt;/Library/Preferences/ctbrec</code>
      <code>/&lt;version&gt;/server.json</code>
    </p>
    <p>You can open this file in a text editor and change it to your likings. You probably only want to change <code>httpPort</code> and <code>recordingsDir</code>. Most of the other stuff is irrelevant since the server and CTB Recorder use the same config file format. When the server is running, you can connect to it with CTB Recorder by changing the setting "Record location" to "Remote". </p>
    <h3 style="color: rgb(255, 153, 0);" id="web-interface">Web Interface</h3>
    <p>You can enable the server's web interface in the configuration server.json. Just set <code>webinterface</code> to true and set values for <code>webinterfaceUsername</code> and <code>webinterfacePassword</code>. </p>
    <h3 id="ssl-tls">SSL / TLS</h3>
    <p>Since version 2.2.0 CTB Recorder supports SSL / TLS. To switch it on/off you have to change the server and client configuration. On the server side open the server.json and set <code>transportLayerSecurity</code> to true. The server will then open an additional port, which can be configured with <code>httpSecurePort</code>. On the client side open CTB Recorder and on the Settings tab change the port to the value of <code>httpSecurePort</code>. Then tick <code>Use Secure Communication (TLS)</code>. Afterwards restart CTB Recorder and you should be able to connect to the server. </p>
    <p>By default, CTB Recorder uses a self-signed certificate. If you also use the webinterface, your browser will complain about that, but you can just ignore the warning and add the certificate to your trusted certificates.</p>
    <h4 id="custom-certificate">Custom certificate</h4>
    <p>You can also use your own certificate, if you want to. Follow these steps to create a keystore, which can be used by the server:</p>
    <ul>
      <li>
        <code>cd &lt;your_ctbrec_directory&gt;</code>
      </li>
      <li>
        <code>openssl pkcs12 -export -in &lt;certificate&gt;.pem -inkey &lt;private_key&gt;.pem -out &lt;some_name&gt;.p12 -chain -name &lt;some_name&gt; -CAfile &lt;ca_certificate&gt;.crt -caname root</code>
      </li>
      <li>
        <code>keytool -v -importkeystore -srckeystore &lt;some_name&gt;.org.p12 -srcstoretype PKCS12 -destkeystore &lt;some_name&gt;.ks -deststoretype PKCS12</code> (keytool is part of the Java distribution, so you should be able to find it in the bin directory of your Java installation. If not, download the current JDK from jdk.java.net). You will be asked to enter a password during the process. Enter the same password everytime and note that down.
      </li>
      <li>Open the server.sh / server.bat</li>
      <li>add <code>-Dkeystore.file=&lt;some_name&gt;.ks -Dkeystore.password=&lt;your_password&gt;</code> directly after $JAVA / java </li>
    </ul>
    <h4 id="running-behind-apache-nginx">Running behind Apache / NGINX</h4>
    <p>You can also run the CTB Recorder server behind Apache or NGINX. I only tested it with Apache and mod_proxy:</p>
    <ul>
      <li>disable <code>transportLayerSecurity</code> in the server.json, TLS should be handled by Apache </li>
      <li>set <code>servletContext</code> to <code>/ctbrec</code>
      </li>
      <li>
        <p>in your Apache config add:</p>
        <p>
          <code>ProxyPass /ctbrec http://localhost:8080/ctbrec</code>
        </p>
        <p>
          <code>ProxyPassReverse /ctbrec http://localhost:8080/ctbrec</code>
        </p>
      </li>
      <li>CTB Recorder will then be available under <code>https://your.server.name/ctbrec</code>, the webinterface (if enabled) under <code>https://your.server.name/ctbrec/static/index.html</code>
      </li>
      <li>in the CTB Recorder app on the Settings tab enter <code>your.server.name</code> for the Server, <code>443</code> for the port, <code>/ctbrec</code> for the path. </li>
      <li>tick <code>Use Secure Communication (TLS)</code>
      </li>
    </ul>
  </body>
</html>